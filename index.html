<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<link rel="stylesheet" href="1.css">
	<title>Document</title>
</head>
<body>
<!-- 	<h1><a href="Ho_Van_Minh_PHP.pdf">Download cv word</a></h1>
	<h1><a href="HO_VAN_MINH_PHP.pdf">Download cv pdf</a></h1> -->
	<!-- <h1><a href="Tax-01-2021-PLHD-MinhNV-HTV-210502.doc">hp</a></h1> -->
	<!-- <div class="thongtin">
		<b>Author:</b> <i>HO VAN LA</i>
	</div> -->
	{
  "api": [
    {
      "api_id": "1588922628540-1b8ae0b1a7",
      "api_name": "insert-product",
      "api_query": "INSERT INTO products(id, name, image) VALUES({{id}}, \"{{name}}\", \"{{image}}\") ON DUPLICATE KEY UPDATE    \nname=\"{{name}}\", image=\"{{image}}\"",
      "enable_web": true,
      "enable_table": false
    },
    {
      "api_id": "1610505775902-73af0adadb",
      "api_name": "insert-order",
      "api_query": "SET @ProductList = \"{{items}}\";\nSET @Name= \"{{name}}\";\nSET @QtyList = \"{{quantities}}\";\nSET @NumProduct = CHAR_LENGTH(@ProductList) - CHAR_LENGTH(REPLACE(@ProductList, ',', ''));\nINSERT INTO orders(items, quantities, total, name, create_time) VALUES(@ProductList, @QtyList, @NumProduct + 1, @Name, now() );\nSELECT id, create_time INTO @OrderID, @Create_time FROM orders ORDER BY ID DESC LIMIT 1;\n-- SET @OrderID = LAST_INSERT_ID();\n\nINSERT INTO order_details (order_id, product_id, quantity)\nSELECT @OrderID, PL.ProductID, PL.Qty FROM\n(select\n  SUBSTRING_INDEX(SUBSTRING_INDEX(@ProductList, ',', Rownb), ',', -1) ProductID,\n  SUBSTRING_INDEX(SUBSTRING_INDEX(@QtyList, ',', Rownb), ',', -1) Qty\nfrom\n  RowNumber\n  where Rownb <= @NumProduct + 1) PL;\nSELECT @OrderID, @Create_time;",
      "enable_web": true,
      "enable_table": false
    },
    {
      "api_id": "1617088581133-717300540a",
      "api_name": "clear-all-orders",
      "api_query": "SET FOREIGN_KEY_CHECKS = 0;\nTRUNCATE order_details; \nTRUNCATE orders; \nSET FOREIGN_KEY_CHECKS = 1;",
      "enable_web": true,
      "enable_table": false
    },
    {
      "api_id": "1617088607364-595aebbd89",
      "api_name": "IO-complete-confirm",
      "api_query": "--Xác nhận xong 1 sp, bị thay thế bằng hàm IO-complete-confirm-get-status\nUPDATE mysql_db.order_details SET status = 1 \nWHERE order_id = {{c1}} AND product_id = {{c2}};\nSET @DONE_COUNT = (SELECT SUM(status) FROM order_details WHERE order_details.order_id = {{c1}});\nUPDATE mysql_db.orders SET completed = @DONE_COUNT WHERE id = {{c1}};\nSELECT completed as c1, total as c2 FROM orders WHERE id = {{c1}};",
      "enable_web": true,
      "enable_table": false
    },
    {
      "api_id": "1617088631983-c510054f31",
      "api_name": "IO-check-order",
      "api_query": "SELECT completed as c1, total as c2 FROM orders WHERE id = {{c1}};",
      "enable_web": true,
      "enable_table": false
    },
    {
      "api_id": "1617088646933-00702a929a",
      "api_name": "IO-get-order",
      "api_query": "SET @create_time = \"\", @completed = null, @total = null;\nSELECT create_time, completed, total INTO @create_time, @completed, @total FROM orders WHERE id = {{c1}};\nSELECT @create_time as c1, GROUP_CONCAT(product_id) as c2, GROUP_CONCAT(quantity) as c3, @completed as c4, @total as c5\nFROM order_details WHERE order_id = {{c1}} AND product_id >= {{c2}} AND product_id <= {{c3}} AND status = 0;",
      "enable_web": true,
      "enable_table": false
    },
    {
      "api_id": "1617088657219-711bf03faa",
      "api_name": "IO-get-last-order-id",
      "api_query": "SELECT order_id as c1 FROM order_details WHERE product_id >= {{c1}} AND product_id <= {{c2}} AND status = 0 LIMIT 1;",
      "enable_web": true,
      "enable_table": false
    },
    {
      "api_id": "1617192174752-267a9b2851",
      "api_name": "IO-complete-confirm-get-status",
      "api_query": "UPDATE mysql_db.order_details SET status = 1 \nWHERE order_id = {{c1}} AND product_id = {{c2}};\nSET @DONE_COUNT = (SELECT SUM(status) FROM order_details WHERE order_details.order_id = {{c1}});\nUPDATE mysql_db.orders SET completed = @DONE_COUNT WHERE id = {{c1}};\nSET @create_time = \"\", @completed = null, @total = null;\nSELECT create_time, completed, total INTO @create_time, @completed, @total FROM orders WHERE id = {{c1}};\nSELECT @completed as c1, @total as c2, GROUP_CONCAT(product_id) as c3, GROUP_CONCAT(quantity) as c4\nFROM order_details WHERE order_id = {{c1}} AND product_id >= {{c3}} AND product_id <= {{c4}} AND status = 0;",
      "enable_web": true,
      "enable_table": false
    },
    {
      "api_id": "1617198529741-37c4c54b08",
      "api_name": "IO-forced-complete-order",
      "api_query": "UPDATE mysql_db.order_details SET status = 1 \nWHERE order_id = {{c1}};\nUPDATE mysql_db.orders SET completed = total WHERE id = {{c1}};",
      "enable_web": true,
      "enable_table": false
    },
    {
      "api_id": "1617213786861-563dcf9e58",
      "api_name": "IO-delete-order",
      "api_query": "DELETE FROM orders WHERE id = {{c1}};",
      "enable_web": true,
      "enable_table": false
    },
    {
      "api_id": "1619163283152-6a45414042",
      "api_name": "get-update-id",
      "api_query": "UPDATE mysql_db.orders  SET export_status= 1, export_time= now(),  update_time= now()\nWHERE id= {{c1}};\nselect * from mysql_db.orders where export_status= 1  ORDER BY update_time DESC;\n",
      "enable_web": true,
      "enable_table": false
    },
    {
      "api_id": "1619164096208-7a617d043d",
      "api_name": "get-all-products",
      "api_query": "select * from products;",
      "enable_web": true,
      "enable_table": false
    },
    {
      "api_id": "1619167562182-0ee2de12e4",
      "api_name": "update-exported-id",
      "api_query": "UPDATE mysql_db.orders SET export_status= 2\nWHERE id = {{c1}};",
      "enable_web": true,
      "enable_table": false
    },
    {
      "api_id": "1619167960736-d2d0abe73d",
      "api_name": "get-all-exported",
      "api_query": "select * from orders where export_status=1  ORDER BY update_time DESC",
      "enable_web": true,
      "enable_table": false
    },
    {
      "api_id": "1619669764325-b524fa6fd4",
      "api_name": "get-order-id",
      "api_query": "select * from orders where id = {{c1}};",
      "enable_web": true,
      "enable_table": false
    },
    {
      "api_id": "1620105257238-d692e83915",
      "api_name": "get-update-id-repeat",
      "api_query": "UPDATE mysql_db.orders  SET export_status= 1, update_time= now()\nWHERE id= {{c1}};\nselect * from mysql_db.orders where export_status= 1 ORDER BY update_time DESC;",
      "enable_web": true,
      "enable_table": false
    }
  ],
  "user": [
    {
      "username": "admin",
      "pwdhash": "0b02568cef433d9b985b80b98f81dc89ed337a3013db0e7f6ad6fe5ae81dd6a8",
      "token": "123456",
      "role": "admin",
      "active": true
    },
    {
      "username": "hello",
      "pwdhash": "de594a20677bdc28d55fd7b7bbfc88e9e87b86e79af434bc23285a60af5dfc4f",
      "role": "publisher",
      "token": "sdhfljwelnk",
      "active": true
    }
  ]
}
</body>
</html>
